<!DOCTYPE html>
<html> 
<head> 
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" /> 
	<title>Customer Locations</title> 
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAHKjurndAThRXV5QyBUKXZ_eKGh3V5d9M&"
	type="text/javascript"></script>
	<link rel="stylesheet" type="text/css" href="style.css">
</head> 

<body>
  	<div id="map"></div>

  	<script type="text/javascript">

	var locations = [
		["Albertsons", "Anna Arbor", "575 College Dr 89015", "702 568 0115", 30000, "Basic"],
		["Caesars Entertainment Corp.", "Carl Cooper", "Caesars Palace Drive 89109", "866 227 5938", 500000, "Gold"],
		["Kenworth Sales Company", "Kelly Kellerson", "3033 Losee Road 89030", "702 399 2424", 95000, "Silver"],
		["Las Vegas Sands Corp.", "Laura Little", "3355 Las Vegas Blvd. South 89109", "702 414 1000", 1000000, "Platinum"],
		["Santa Fe Station Hotel & Casino", "Samuel Smith", "4949 N Rancho Dr 89130", "866 767 7770", 20000000, "Platinum"]
	];

	function dataToHtml(loc) {
		var brk = "</br><b>";
		return "<b>" + loc[0] + brk + loc[1] + brk + loc[2] + brk + loc[3] + brk + "Balance: $" + loc[4] + brk + "Account Type: " + loc[5] + "</br>";
	}

	var delay = 100;
	var infowindow = new google.maps.InfoWindow();
	var latlng = new google.maps.LatLng(36.1468966580206,-115.14239686803545);

	var mapOptions = {
		zoom: 11,
		center: latlng,
		mapTypeId: google.maps.MapTypeId.ROADMAP
	}
  
	var geocoder = new google.maps.Geocoder(); 
	var map = new google.maps.Map(document.getElementById("map"), mapOptions);
	var bounds = new google.maps.LatLngBounds();

	function geocodeAddress(address, theInfo, next) {
	    geocoder.geocode({address:address}, function (results,status){ 
		    if (status == google.maps.GeocoderStatus.OK) {
				var p = results[0].geometry.location;
				var lat=p.lat();
				var lng=p.lng();
				createMarker(theInfo,lat,lng);
		    }
		    else {
		     	if (status == google.maps.GeocoderStatus.OVER_QUERY_LIMIT) {
		     		nextAddress--;
		     		delay++;
		    	} 
  			}
  			next();
		}
	);}

	function createMarker(theInfo,lat,lng) {
		console.log(theInfo);
		var contentString = theInfo;
		var marker = new google.maps.Marker({position: new google.maps.LatLng(lat,lng), map: map,});

		google.maps.event.addListener(marker, 'click', function() {
	    	infowindow.setContent(contentString); 
	    	infowindow.open(map,marker);
		});

	   bounds.extend(marker.position);
	}

	function theNext() {
		if (nextAddress < locations.length) {
			setTimeout('geocodeAddress("'+ locations[nextAddress][2] +'","'+ dataToHtml(locations[nextAddress]) +'",theNext)', delay);
			nextAddress++;
		} 
		else {
			map.fitBounds(bounds);
		}
	}

	var nextAddress = 0;
	theNext();

</script>

</body>
</html>